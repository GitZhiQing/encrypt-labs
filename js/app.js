document[_0x52fd6f(-0x16d,-0x17b)](_0x52fd6f(-0x16c,-0x156))[_0x52fd6f(-0x16b,-0x171)](_0x52fd6f(-0x16a,-0x156),function(_0x2934c6){_0x2934c6['preventDefault']();function _0x1b855b(_0x5bd5d1,_0x3eac75){return _0x52fd6f(_0x5bd5d1-0x14b,_0x3eac75);}document['getElementById']('modal')[_0x1b855b(-0x1e,-0x16)][_0x1b855b(-0x1d,-0x9)]='flex';});function _0x5474(){const _0x578c81=['getElementById','loginForm','addEventListener','submit','style','display','value','password','stringify','AES','encryptedData=','json','then','用户名或密码错误','error','\x0a-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----\x0a\x20\x20','setPublicKey','append','toString','success','success.html','username','mode','CBC','Pkcs7','application/json','登录成功','Base64','pad','href','请求错误:','enc','Utf8','DES','encrypt','POST','catch','random','location','now','signature','签名验证失败，数据可能被篡改','verify','application/json;\x20charset=utf-8'];_0x5474=function(){return _0x578c81;};return _0x5474();}function sendDataAes(_0x42c95d){const _0x1edd61={'username':document[_0x37de25(-0xda,-0xed)]('username')[_0x37de25(-0xd5,-0xe7)],'password':document[_0x37de25(-0xe5,-0xed)](_0x37de25(-0xd6,-0xe6))['value']},_0x53f989=JSON[_0x37de25(-0xef,-0xe5)](_0x1edd61),_0x3c2d96=CryptoJS['enc']['Utf8']['parse']('1234567890123456'),_0x998fe8=CryptoJS['enc']['Utf8']['parse']('1234567890123456');function _0x37de25(_0x802d07,_0xe4e6e9){return _0x52fd6f(_0xe4e6e9-0x80,_0x802d07);}const _0x21a39a=CryptoJS[_0x37de25(-0xe9,-0xe4)]['encrypt'](_0x53f989,_0x3c2d96,{'iv':_0x998fe8,'mode':CryptoJS['mode']['CBC'],'padding':CryptoJS['pad']['Pkcs7']})['toString'](),_0x24bd0b=_0x37de25(-0xd8,-0xe3)+encodeURIComponent(_0x21a39a);fetch(_0x42c95d,{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded;\x20charset=utf-8'},'body':_0x24bd0b})['then'](_0x318167=>_0x318167[_0x37de25(-0xd6,-0xe2)]())[_0x37de25(-0xf0,-0xe1)](_0x49c474=>{function _0x36da29(_0x2b4541,_0x4f612c){return _0x37de25(_0x4f612c,_0x2b4541-0x12);}_0x49c474['success']?(alert('登录成功'),window['location']['href']='success.html'):alert(_0x36da29(-0xce,-0xdf));})['catch'](_0x34942f=>{function _0xe280e9(_0x214a09,_0x15410a){return _0x37de25(_0x15410a,_0x214a09-0x19a);}console[_0xe280e9(0xbb,0xce)]('请求错误:',_0x34942f);}),closeModal();}function sendEncryptedDataRSA(_0x2d546f){const _0x4b5f57=_0x250215(0x136,0x12e),_0x35e2aa=document[_0x250215(0x127,0x124)]('username')['value'],_0x55f547=document['getElementById']('password')['value'],_0x548eca={'username':_0x35e2aa,'password':_0x55f547},_0x3bc9d3=JSON['stringify'](_0x548eca);function _0x250215(_0x3fb365,_0x1f26ad){return _0x52fd6f(_0x3fb365-0x294,_0x1f26ad);}const _0x3c565a=new JSEncrypt();_0x3c565a[_0x250215(0x137,0x149)](_0x4b5f57);const _0x49b7f3=_0x3c565a['encrypt'](_0x3bc9d3);if(!_0x49b7f3){alert('加密失败，请检查公钥是否正确');return;}const _0xfce2c4=new URLSearchParams();_0xfce2c4[_0x250215(0x138,0x126)]('data',_0x49b7f3),fetch(_0x2d546f,{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0xfce2c4[_0x250215(0x139,0x135)]()})['then'](_0x5a9697=>_0x5a9697['json']())[_0x250215(0x133,0x12f)](_0x183bcd=>{function _0x42def3(_0x2a0111,_0x21a0ce){return _0x250215(_0x2a0111-0x34f,_0x21a0ce);}_0x183bcd[_0x42def3(0x489,0x49f)]?(alert('登录成功'),window['location']['href']=_0x42def3(0x48a,0x48c)):alert(_0x183bcd['error']||'用户名或密码错误');})['catch'](_0x4f8a2c=>console[_0x250215(0x135,0x131)]('请求错误:',_0x4f8a2c)),closeModal();}function sendDataAesRsa(_0x3a7845){function _0x4893b8(_0x3a322b,_0x208c3e){return _0x52fd6f(_0x208c3e-0x181,_0x3a322b);}const _0x35b4a8={'username':document['getElementById'](_0x4893b8(0x14,0x29))['value'],'password':document[_0x4893b8(0x1f,0x14)]('password')['value']},_0x4e1edc=JSON['stringify'](_0x35b4a8),_0x32759b=CryptoJS['lib']['WordArray']['random'](0x10),_0x5ed073=CryptoJS['lib']['WordArray']['random'](0x10),_0x20cfcf=CryptoJS['AES']['encrypt'](_0x4e1edc,_0x32759b,{'iv':_0x5ed073,'mode':CryptoJS[_0x4893b8(0x1e,0x2a)][_0x4893b8(0x3b,0x2b)],'padding':CryptoJS['pad'][_0x4893b8(0x2b,0x2c)]})['toString'](),_0x194ce7=new JSEncrypt();_0x194ce7['setPublicKey']('-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----');const _0x357bf1=_0x194ce7['encrypt'](_0x32759b['toString'](CryptoJS['enc']['Base64'])),_0x373c6d=_0x194ce7['encrypt'](_0x5ed073['toString'](CryptoJS['enc']['Base64']));fetch(_0x3a7845,{'method':'POST','headers':{'Content-Type':_0x4893b8(0x27,0x2d)},'body':JSON['stringify']({'encryptedData':_0x20cfcf,'encryptedKey':_0x357bf1,'encryptedIv':_0x373c6d})})['then'](_0xe92ca9=>_0xe92ca9['json']())['then'](_0x5e538f=>{function _0x44cf75(_0x344001,_0xf56985){return _0x4893b8(_0xf56985,_0x344001-0x27d);}_0x5e538f[_0x44cf75(0x2a4,0x2a0)]?(alert(_0x44cf75(0x2ab,0x2bf)),window['location']['href']='success.html'):alert(_0x44cf75(0x29e,0x290));})['catch'](_0x990d77=>console[_0x4893b8(0xd,0x22)]('请求错误:',_0x990d77)),closeModal();}function _0x39e0(_0x2655b7,_0x5474ef){const _0x39e0c1=_0x5474();return _0x39e0=function(_0x138c81,_0x5e703a){_0x138c81=_0x138c81-0x192;let _0x4c12c1=_0x39e0c1[_0x138c81];return _0x4c12c1;},_0x39e0(_0x2655b7,_0x5474ef);}async function fetchAndSendDataAes(_0x1933de){let _0x373a98,_0x3d991e;function _0x2ca29a(_0x4a54e7,_0x26fff9){return _0x52fd6f(_0x26fff9-0x499,_0x4a54e7);}try{const _0x495be2=await fetch('encrypt/server_generate_key.php'),_0x39dba0=await _0x495be2['json']();_0x373a98=CryptoJS['enc'][_0x2ca29a(0x33b,0x347)]['parse'](_0x39dba0['aes_key']),_0x3d991e=CryptoJS['enc'][_0x2ca29a(0x349,0x347)]['parse'](_0x39dba0['aes_iv']);}catch(_0x507b3d){console['error']('获取\x20AES\x20密钥失败:',_0x507b3d),alert('无法获取\x20AES\x20密钥，请刷新页面重试');return;}const _0x1d131e={'username':document[_0x2ca29a(0x33a,0x32c)]('username')['value'],'password':document['getElementById']('password')[_0x2ca29a(0x330,0x332)]},_0x10b00f=JSON['stringify'](_0x1d131e),_0x1ab045=CryptoJS['AES']['encrypt'](_0x10b00f,_0x373a98,{'iv':_0x3d991e,'mode':CryptoJS[_0x2ca29a(0x32f,0x342)]['CBC'],'padding':CryptoJS[_0x2ca29a(0x35d,0x348)][_0x2ca29a(0x33b,0x344)]})['toString']();fetch(_0x1933de,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'encryptedData':_0x1ab045})})[_0x2ca29a(0x34a,0x338)](_0x2ae795=>_0x2ae795['json']())[_0x2ca29a(0x32b,0x338)](_0x58ded5=>{function _0x3ef53a(_0x88658b,_0x1a2271){return _0x2ca29a(_0x1a2271,_0x88658b- -0xbb);}_0x58ded5['success']?(alert('登录成功'),window['location'][_0x3ef53a(0x28e,0x28e)]='success.html'):alert(_0x3ef53a(0x27e,0x27e));})['catch'](_0x9971ed=>console['error'](_0x2ca29a(0x351,0x34a),_0x9971ed)),closeModal();}function encryptAndSendDataDES(_0x38f830){const _0x420c9e=document['getElementById'](_0x5c5aa1(0x430,0x42e))[_0x5c5aa1(0x421,0x42d)],_0x3c8694=document[_0x5c5aa1(0x41b,0x41a)]('password')['value'],_0x3d603d=CryptoJS[_0x5c5aa1(0x43a,0x42d)][_0x5c5aa1(0x43b,0x444)]['parse'](_0x420c9e['slice'](0x0,0x8)['padEnd'](0x8,'6')),_0x4abada=CryptoJS[_0x5c5aa1(0x43a,0x429)][_0x5c5aa1(0x43b,0x43a)]['parse']('9999'+_0x420c9e['slice'](0x0,0x4)['padEnd'](0x4,'9'));function _0x5c5aa1(_0x77d86f,_0x87db44){return _0x52fd6f(_0x77d86f-0x588,_0x87db44);}const _0xacbc28=CryptoJS[_0x5c5aa1(0x43c,0x435)][_0x5c5aa1(0x43d,0x444)](_0x3c8694,_0x3d603d,{'iv':_0x4abada,'mode':CryptoJS[_0x5c5aa1(0x431,0x41d)][_0x5c5aa1(0x432,0x41e)],'padding':CryptoJS[_0x5c5aa1(0x437,0x427)]['Pkcs7']}),_0x31019a=_0xacbc28['ciphertext']['toString'](CryptoJS['enc']['Hex']);fetch(_0x38f830,{'method':_0x5c5aa1(0x43e,0x439),'headers':{'Content-Type':'application/json'},'body':JSON[_0x5c5aa1(0x423,0x42c)]({'username':_0x420c9e,'password':_0x31019a})})[_0x5c5aa1(0x427,0x437)](_0x2c33d9=>_0x2c33d9[_0x5c5aa1(0x426,0x436)]())['then'](_0x105d64=>{function _0x2a8e11(_0x3dbc94,_0x1a29bd){return _0x5c5aa1(_0x1a29bd- -0x5f7,_0x3dbc94);}_0x105d64[_0x2a8e11(-0x1d6,-0x1c9)]?(alert('登录成功'),window['location'][_0x2a8e11(-0x1c7,-0x1bf)]=_0x2a8e11(-0x1bb,-0x1c8)):alert('用户名或密码错误');})[_0x5c5aa1(0x43f,0x438)](_0x339f3f=>console['error'](_0x5c5aa1(0x439,0x437),_0x339f3f)),closeModal();}function sendDataWithNonce(_0x51e8e0){const _0x1ebb31=document['getElementById'](_0x20dc70(0x412,0x41b))['value'],_0x46b8c6=document[_0x20dc70(0x3fb,0x406)]('password')['value'],_0x50f826=Math[_0x20dc70(0x421,0x42b)]()['toString'](0x24)['substring'](0x2),_0xfe3cef=Math['floor'](Date['now']()/0x3e8),_0x2b211f='be56e057f20f883e',_0x18fbb0=_0x1ebb31+_0x46b8c6+_0x50f826+_0xfe3cef,_0xedccf2=CryptoJS['HmacSHA256'](_0x18fbb0,_0x2b211f)['toString'](CryptoJS['enc']['Hex']);function _0x20dc70(_0x2f1655,_0x568425){return _0x52fd6f(_0x568425-0x573,_0x2f1655);}fetch(_0x51e8e0,{'method':_0x20dc70(0x43d,0x429),'headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'username':_0x1ebb31,'password':_0x46b8c6,'nonce':_0x50f826,'timestamp':_0xfe3cef,'signature':_0xedccf2})})['then'](_0x13f1d7=>_0x13f1d7['json']())['then'](_0x54a241=>{function _0x4bfa74(_0x1b8a03,_0x2ee1ad){return _0x20dc70(_0x1b8a03,_0x2ee1ad- -0x42c);}_0x54a241[_0x4bfa74(-0x15,-0x13)]?(alert('登录成功'),window[_0x4bfa74(-0xd,0x0)]['href']='success.html'):alert(_0x54a241['error']||_0x4bfa74(-0xb,-0x19));})['catch'](_0x336bc8=>console['error']('请求错误:',_0x336bc8)),closeModal();}function sendDataWithSignatureRsa(_0x2b1b55){const _0x15a294='\x0a-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----\x0a\x20\x20',_0x55b005=document['getElementById']('username')['value'],_0x23b24d=document['getElementById'](_0x28d4b6(0x4ca,0x4c0))['value'],_0xd87b2c=Math['random']()['toString'](0x24)['substring'](0x2),_0x496105=Math['floor'](Date[_0x28d4b6(0x4d6,0x4e0)]()/0x3e8);async function _0x4e7f55(){function _0x3a6ebf(_0x506959,_0x1bb473){return _0x28d4b6(_0x506959,_0x1bb473-0x8d);}const _0x39c7d2={'username':_0x55b005,'password':_0x23b24d,'nonce':_0xd87b2c,'timestamp':_0x496105};try{const _0x3405b1=await fetch(_0x2b1b55,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0x3a6ebf(0x544,0x54e)](_0x39c7d2)}),_0x547a41=await _0x3405b1['json']();if(_0x547a41['success']&&_0x547a41[_0x3a6ebf(0x577,0x56e)]){const _0x490b13=_0x55b005+_0x23b24d+_0xd87b2c+_0x496105,_0x5b20df=_0xc8129c(_0x490b13,_0x547a41[_0x3a6ebf(0x562,0x56e)],_0x15a294);_0x5b20df?(alert('签名验证成功，登录成功'),window[_0x3a6ebf(0x55a,0x56c)]['href']=_0x3a6ebf(0x563,0x55a)):alert(_0x3a6ebf(0x579,0x56f));}else alert(_0x547a41['error']||'用户名或密码错误');}catch(_0x11ebf9){console['error'](_0x3a6ebf(0x578,0x564),_0x11ebf9),alert('请求失败，请检查网络连接');}}function _0x28d4b6(_0x4c4d25,_0x2611f2){return _0x52fd6f(_0x2611f2-0x626,_0x4c4d25);}_0x4e7f55();function _0xc8129c(_0x436263,_0x378cce,_0x21f10f){function _0x4af38d(_0x518580,_0x2a85a8){return _0x28d4b6(_0x518580,_0x2a85a8- -0x53d);}const _0x32c0b6=new JSEncrypt();return _0x32c0b6['setPublicKey'](_0x21f10f),_0x32c0b6[_0x4af38d(-0x6b,-0x5a)](_0x436263,_0x378cce,CryptoJS['SHA256']);}closeModal();}function generateRequestData(){const _0x880fd6=document['getElementById'](_0xe85dd8(-0xa3,-0x8d))['value'],_0x3e40b9=document[_0xe85dd8(-0xb5,-0xa2)]('password')['value'],_0x12391f=Date['now'](),_0x3a70a9={'username':_0x880fd6,'password':_0x3e40b9,'timestamp':_0x12391f};function _0xe85dd8(_0x564056,_0x2176f7){return _0x52fd6f(_0x2176f7-0xcb,_0x564056);}return _0x3a70a9;}function sendLoginRequest(_0x5395a2){const _0x291835=generateRequestData();fetch(_0x5395a2,{'method':'POST','headers':{'Content-Type':_0x423ad8(-0x131,-0x12c)},'body':JSON['stringify'](_0x291835)})[_0x423ad8(-0x150,-0x166)](_0x2c2b80=>_0x2c2b80['json']())[_0x423ad8(-0x150,-0x156)](_0x443f0b=>{function _0x5edc73(_0x257a65,_0x765297){return _0x423ad8(_0x765297-0x3aa,_0x257a65);}_0x443f0b['success']?(alert('登录成功'),window['location']['href']='success.html'):alert(_0x443f0b[_0x5edc73(0x251,0x25c)]||_0x5edc73(0x24b,0x25b));})['catch'](_0x39587d=>console[_0x423ad8(-0x14e,-0x149)]('请求错误:',_0x39587d));function _0x423ad8(_0x640d96,_0x804654){return _0x52fd6f(_0x640d96-0x11,_0x804654);}closeModal();}function _0x52fd6f(_0x4268b5,_0x23a268){return _0x39e0(_0x4268b5- -0x2ff,_0x23a268);}function closeModal(){document['getElementById']('modal')['style']['display']='none';}
