document['getElementById']('loginForm')[_0x2d2d16(-0x210,-0x220)](_0x2d2d16(-0x20e,-0x21f),function(_0x23de63){_0x23de63['preventDefault']();function _0x170d0a(_0x45397a,_0x24df56){return _0x2d2d16(_0x24df56,_0x45397a-0x3cf);}document['getElementById']('modal')['style']['display']=_0x170d0a(0x1b1,0x1be);});function sendDataAes(_0x1b5ff2){const _0x2e3e74={'username':document[_0x1b7e98(0x79,0x82)](_0x1b7e98(0x7a,0x84))['value'],'password':document[_0x1b7e98(0x79,0x74)]('password')[_0x1b7e98(0x7b,0x7c)]},_0x27cce5=JSON['stringify'](_0x2e3e74),_0x5b98b1=CryptoJS[_0x1b7e98(0x7c,0x82)]['Utf8'][_0x1b7e98(0x7d,0x69)]('1234567890123456'),_0x2181cb=CryptoJS['enc']['Utf8']['parse'](_0x1b7e98(0x7e,0x6d));function _0x1b7e98(_0x59ac9d,_0x5524ca){return _0x2d2d16(_0x5524ca,_0x59ac9d-0x296);}const _0x2b4ba4=CryptoJS[_0x1b7e98(0x7f,0x96)][_0x1b7e98(0x80,0x89)](_0x27cce5,_0x5b98b1,{'iv':_0x2181cb,'mode':CryptoJS['mode'][_0x1b7e98(0x81,0x80)],'padding':CryptoJS[_0x1b7e98(0x82,0x6b)][_0x1b7e98(0x83,0x8f)]})['toString'](),_0x341faf='encryptedData='+encodeURIComponent(_0x2b4ba4);fetch(_0x1b5ff2,{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded;\x20charset=utf-8'},'body':_0x341faf})['then'](_0x17ae96=>_0x17ae96[_0x1b7e98(0x84,0x77)]())['then'](_0x3dbc39=>{function _0x24c878(_0x95ebaf,_0x2cbd36){return _0x1b7e98(_0x2cbd36-0x37d,_0x95ebaf);}_0x3dbc39[_0x24c878(0x3f3,0x402)]?(alert('登录成功'),window[_0x24c878(0x3fc,0x403)]['href']=_0x24c878(0x41b,0x404)):alert(_0x24c878(0x3f1,0x405));})[_0x1b7e98(0x89,0x7f)](_0xe5ae1a=>{console['error']('请求错误:',_0xe5ae1a);}),closeModal();}function sendEncryptedDataRSA(_0x3be372){const _0x243569='\x0a-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----\x0a\x20\x20',_0x2b4a78=document[_0x4c2866(0x178,0x185)]('username')[_0x4c2866(0x17a,0x181)];function _0x4c2866(_0x2c58f5,_0x26555e){return _0x2d2d16(_0x26555e,_0x2c58f5-0x395);}const _0x24ca1a=document[_0x4c2866(0x178,0x181)](_0x4c2866(0x189,0x196))[_0x4c2866(0x17a,0x16a)],_0x184254={'username':_0x2b4a78,'password':_0x24ca1a},_0x5c9ea6=JSON[_0x4c2866(0x18a,0x190)](_0x184254),_0x5ad0a2=new JSEncrypt();_0x5ad0a2['setPublicKey'](_0x243569);const _0x43d0cf=_0x5ad0a2['encrypt'](_0x5c9ea6);if(!_0x43d0cf){alert(_0x4c2866(0x18b,0x189));return;}const _0x150d6b=new URLSearchParams();_0x150d6b['append']('data',_0x43d0cf),fetch(_0x3be372,{'method':_0x4c2866(0x18c,0x193),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x150d6b[_0x4c2866(0x18d,0x178)]()})['then'](_0x1e5c9d=>_0x1e5c9d['json']())['then'](_0x2d2601=>{function _0x247b49(_0x2c2efc,_0x4d33b2){return _0x4c2866(_0x4d33b2- -0x325,_0x2c2efc);}_0x2d2601['success']?(alert(_0x247b49(-0x187,-0x197)),window['location'][_0x247b49(-0x19f,-0x196)]='success.html'):alert(_0x2d2601['error']||'用户名或密码错误');})[_0x4c2866(0x188,0x173)](_0x1a9b42=>console[_0x4c2866(0x190,0x19c)]('请求错误:',_0x1a9b42)),closeModal();}function _0x5415(_0xb50fc5,_0x444253){const _0x5415d2=_0x4442();return _0x5415=function(_0x949b0f,_0x18d03f){_0x949b0f=_0x949b0f-0xfe;let _0x1b6c3a=_0x5415d2[_0x949b0f];return _0x1b6c3a;},_0x5415(_0xb50fc5,_0x444253);}function sendDataAesRsa(_0x39d3a6){const _0x82b1ec={'username':document[_0x1c3bed(0x1d0,0x1d7)]('username')['value'],'password':document['getElementById']('password')['value']},_0x4e2e4c=JSON[_0x1c3bed(0x1e2,0x1dc)](_0x82b1ec),_0x395c00=CryptoJS['lib']['WordArray'][_0x1c3bed(0x1e9,0x1f7)](0x10),_0x1f933f=CryptoJS['lib']['WordArray']['random'](0x10),_0x2c368b=CryptoJS['AES'][_0x1c3bed(0x1d7,0x1ec)](_0x4e2e4c,_0x395c00,{'iv':_0x1f933f,'mode':CryptoJS[_0x1c3bed(0x1ea,0x202)][_0x1c3bed(0x1d8,0x1e6)],'padding':CryptoJS[_0x1c3bed(0x1d9,0x1ea)][_0x1c3bed(0x1da,0x1db)]})['toString'](),_0x1718ff=new JSEncrypt();function _0x1c3bed(_0x197ab3,_0x25d887){return _0x2d2d16(_0x25d887,_0x197ab3-0x3ed);}_0x1718ff[_0x1c3bed(0x1eb,0x1e5)]('-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----');const _0xf1f7a2=_0x1718ff['encrypt'](_0x395c00['toString'](CryptoJS[_0x1c3bed(0x1d3,0x1e2)][_0x1c3bed(0x1ec,0x1ef)])),_0xbcacd5=_0x1718ff['encrypt'](_0x1f933f['toString'](CryptoJS['enc']['Base64']));fetch(_0x39d3a6,{'method':_0x1c3bed(0x1e4,0x1ee),'headers':{'Content-Type':_0x1c3bed(0x1ed,0x1fb)},'body':JSON[_0x1c3bed(0x1e2,0x1d9)]({'encryptedData':_0x2c368b,'encryptedKey':_0xf1f7a2,'encryptedIv':_0xbcacd5})})[_0x1c3bed(0x1ee,0x1ff)](_0x11f889=>_0x11f889['json']())['then'](_0x13e3de=>{function _0x410719(_0x2a01c8,_0x2b407f){return _0x1c3bed(_0x2b407f-0x2da,_0x2a01c8);}_0x13e3de['success']?(alert('登录成功'),window[_0x410719(0x4cb,0x4b7)]['href']=_0x410719(0x4a8,0x4b8)):alert('用户名或密码错误');})[_0x1c3bed(0x1e0,0x1d6)](_0x19f7f7=>console['error']('请求错误:',_0x19f7f7)),closeModal();}async function fetchAndSendDataAes(_0x3ed87e){function _0x370308(_0x190599,_0x4da933){return _0x2d2d16(_0x4da933,_0x190599-0x4bc);}let _0x185268,_0xd29ad1;try{const _0x56c971=await fetch(_0x370308(0x2be,0x2c3)),_0x1fec83=await _0x56c971[_0x370308(0x2aa,0x2a1)]();_0x185268=CryptoJS[_0x370308(0x2a2,0x2ac)]['Base64'][_0x370308(0x2a3,0x2b0)](_0x1fec83['aes_key']),_0xd29ad1=CryptoJS['enc'][_0x370308(0x2bb,0x2c4)][_0x370308(0x2a3,0x2a8)](_0x1fec83['aes_iv']);}catch(_0x2fdd64){console['error']('获取\x20AES\x20密钥失败:',_0x2fdd64),alert(_0x370308(0x2bf,0x2c1));return;}const _0x2da9f1={'username':document['getElementById']('username')[_0x370308(0x2a1,0x2b8)],'password':document['getElementById'](_0x370308(0x2b0,0x2c4))[_0x370308(0x2a1,0x296)]},_0x1501bc=JSON['stringify'](_0x2da9f1),_0x1a2b96=CryptoJS[_0x370308(0x2a5,0x299)]['encrypt'](_0x1501bc,_0x185268,{'iv':_0xd29ad1,'mode':CryptoJS['mode']['CBC'],'padding':CryptoJS[_0x370308(0x2a8,0x29d)]['Pkcs7']})[_0x370308(0x2b4,0x2b1)]();fetch(_0x3ed87e,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0x370308(0x2b1,0x2ae)]({'encryptedData':_0x1a2b96})})['then'](_0x47e665=>_0x47e665['json']())[_0x370308(0x2bd,0x2c1)](_0x2cc4db=>{function _0x5d4663(_0x3f3dec,_0x463951){return _0x370308(_0x463951- -0x456,_0x3f3dec);}_0x2cc4db['success']?(alert('登录成功'),window['location']['href']='success.html'):alert(_0x5d4663(-0x1a1,-0x1a8));})['catch'](_0x50c6ad=>console[_0x370308(0x2b7,0x2a9)]('请求错误:',_0x50c6ad)),closeModal();}function _0x2d2d16(_0x6718be,_0x10aded){return _0x5415(_0x10aded- -0x31e,_0x6718be);}function encryptAndSendDataDES(_0x39ba2c){const _0x1f5ff1=document['getElementById']('username')[_0x5cff59(0x3f0,0x3f2)],_0x38ae58=document['getElementById'](_0x5cff59(0x3ed,0x401))['value'],_0x77597a=CryptoJS[_0x5cff59(0x3fb,0x3f3)]['Utf8'][_0x5cff59(0x3ef,0x3f4)](_0x1f5ff1['slice'](0x0,0x8)[_0x5cff59(0x409,0x411)](0x8,'6'));function _0x5cff59(_0x3d8915,_0x4f7298){return _0x2d2d16(_0x3d8915,_0x4f7298-0x60d);}const _0x1f60a6=CryptoJS['enc']['Utf8']['parse']('9999'+_0x1f5ff1['slice'](0x0,0x4)[_0x5cff59(0x41d,0x411)](0x4,'9')),_0x3f068f=CryptoJS['DES']['encrypt'](_0x38ae58,_0x77597a,{'iv':_0x1f60a6,'mode':CryptoJS['mode'][_0x5cff59(0x3fd,0x3f8)],'padding':CryptoJS['pad']['Pkcs7']}),_0x504de5=_0x3f068f['ciphertext'][_0x5cff59(0x412,0x405)](CryptoJS[_0x5cff59(0x3f1,0x3f3)]['Hex']);fetch(_0x39ba2c,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'username':_0x1f5ff1,'password':_0x504de5})})[_0x5cff59(0x404,0x40e)](_0x5c5f7b=>_0x5c5f7b['json']())['then'](_0x5c0add=>{function _0x3e0849(_0x53ba9f,_0x287944){return _0x5cff59(_0x287944,_0x53ba9f- -0x6b8);}_0x5c0add[_0x3e0849(-0x2bc,-0x2b2)]?(alert('登录成功'),window['location'][_0x3e0849(-0x2b1,-0x2c3)]=_0x3e0849(-0x2ba,-0x2d1)):alert(_0x3e0849(-0x2b9,-0x2a9));})['catch'](_0x524e6a=>console[_0x5cff59(0x40c,0x408)]('请求错误:',_0x524e6a)),closeModal();}function sendDataWithNonce(_0x86190){const _0x392f3a=document['getElementById']('username')['value'],_0x1c035f=document['getElementById'](_0x10217d(-0x175,-0x167))['value'];function _0x10217d(_0x2df767,_0x38a7a0){return _0x2d2d16(_0x2df767,_0x38a7a0-0xa5);}const _0x53de03=Math[_0x10217d(-0x167,-0x15f)]()[_0x10217d(-0x15b,-0x163)](0x24)['substring'](0x2),_0x229f34=Math['floor'](Date[_0x10217d(-0x154,-0x156)]()/0x3e8),_0x1a6213=_0x10217d(-0x14c,-0x155),_0xaf4133=_0x392f3a+_0x1c035f+_0x53de03+_0x229f34,_0x93f475=CryptoJS['HmacSHA256'](_0xaf4133,_0x1a6213)['toString'](CryptoJS['enc']['Hex']);fetch(_0x86190,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'username':_0x392f3a,'password':_0x1c035f,'nonce':_0x53de03,'timestamp':_0x229f34,'signature':_0x93f475})})[_0x10217d(-0x16a,-0x15a)](_0x26677b=>_0x26677b['json']())[_0x10217d(-0x14c,-0x15a)](_0x1b085e=>{function _0x50322f(_0x7b2e2f,_0x185d0a){return _0x10217d(_0x7b2e2f,_0x185d0a-0xf9);}_0x1b085e['success']?(alert('登录成功'),window['location']['href']=_0x50322f(-0x80,-0x71)):alert(_0x1b085e[_0x50322f(-0x50,-0x67)]||_0x50322f(-0x77,-0x70));})[_0x10217d(-0x17c,-0x168)](_0x3bd4ba=>console['error'](_0x10217d(-0x169,-0x154),_0x3bd4ba)),closeModal();}async function sendDataWithNonceServer(_0x3a3dad){function _0x4b1531(_0x392bee,_0x2c2f1b){return _0x2d2d16(_0x392bee,_0x2c2f1b-0xc);}const _0x31c8a1=document['getElementById'](_0x4b1531(-0x21e,-0x210))[_0x4b1531(-0x215,-0x20f)],_0x480a50=document['getElementById']('password')['value'],_0x45cdc5=Math['floor'](Date['now']()/0x3e8);try{const _0x811de3=await fetch(_0x3a3dad+_0x4b1531(-0x1ec,-0x1ec),{'method':_0x4b1531(-0x1fb,-0x1fd),'headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'username':_0x31c8a1,'password':_0x480a50,'timestamp':_0x45cdc5})});if(!_0x811de3['ok']){console['error']('获取签名失败:',_0x811de3[_0x4b1531(-0x1e8,-0x1eb)]),alert(_0x4b1531(-0x1e2,-0x1ea));return;}const {signature:_0x32a4a6}=await _0x811de3['json']();if(!_0x32a4a6){alert('签名获取失败，服务器未返回签名。');return;}const _0xcd486d=await fetch(''+_0x3a3dad,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'username':_0x31c8a1,'password':_0x480a50,'timestamp':_0x45cdc5,'signature':_0x32a4a6})});if(!_0xcd486d['ok']){console[_0x4b1531(-0x201,-0x1f9)](_0x4b1531(-0x1e3,-0x1e9),_0xcd486d['statusText']),alert('提交数据失败，请稍后重试。');return;}const _0x35d6a0=await _0xcd486d['json']();_0x35d6a0['success']?(alert(_0x4b1531(-0x202,-0x1fb)),window[_0x4b1531(-0x1f1,-0x204)]['href']='success.html'):alert(_0x35d6a0['error']||'用户名或密码错误');}catch(_0x529b74){console[_0x4b1531(-0x205,-0x1f9)]('请求错误:',_0x529b74),alert('发生错误，请稍后重试。');}}function _0x4442(){const _0x42925d=['addEventListener','submit','flex','getElementById','username','value','enc','parse','1234567890123456','AES','encrypt','CBC','pad','Pkcs7','json','success','location','success.html','用户名或密码错误','catch','password','stringify','加密失败，请检查公钥是否正确','POST','toString','登录成功','href','error','random','mode','setPublicKey','Base64','application/json','then','encrypt/server_generate_key.php','无法获取\x20AES\x20密钥，请刷新页面重试','padEnd','now','be56e057f20f883e','请求错误:','/../get-signature.php','statusText','获取签名失败，请稍后重试。','数据提交失败:','-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----','RSA\x20encryption\x20failed.','application/json;\x20charset=utf-8'];_0x4442=function(){return _0x42925d;};return _0x4442();}function generateRequestData(){const _0x5159b5=document['getElementById']('username')['value'];function _0x306476(_0x3e8dad,_0x51cfd5){return _0x2d2d16(_0x3e8dad,_0x51cfd5-0x22b);}const _0x37ddc0=document['getElementById'](_0x306476(0x30,0x1f))['value'],_0x8246e2=Date['now'](),_0x443eb3=_0x306476(0x32,0x37);function _0x157e58(_0x536fc1,_0x1015cd){function _0x5960b4(_0x298ea3,_0x5c598b){return _0x306476(_0x5c598b,_0x298ea3-0x411);}const _0x769e6c=new JSEncrypt();_0x769e6c['setPublicKey'](_0x1015cd);const _0x15eb8c=_0x769e6c[_0x5960b4(0x426,0x421)](_0x536fc1[_0x5960b4(0x434,0x42c)]());if(!_0x15eb8c)throw new Error(_0x5960b4(0x449,0x44c));return _0x15eb8c;}let _0x546641;try{_0x546641=_0x157e58(_0x8246e2,_0x443eb3);}catch(_0x4646e5){return console['error']('Encryption\x20error:',_0x4646e5),null;}const _0xe81661={'username':_0x5159b5,'password':_0x37ddc0,'random':_0x546641};return _0xe81661;}function sendLoginRequest(_0x1af58d){const _0x124186=generateRequestData();function _0x2ab167(_0x38954a,_0x5c6db0){return _0x2d2d16(_0x5c6db0,_0x38954a-0x83);}fetch(_0x1af58d,{'method':'POST','headers':{'Content-Type':_0x2ab167(-0x16f,-0x17b)},'body':JSON['stringify'](_0x124186)})[_0x2ab167(-0x17c,-0x184)](_0x397561=>_0x397561[_0x2ab167(-0x18f,-0x19f)]())[_0x2ab167(-0x17c,-0x16b)](_0x4999f1=>{function _0xde5822(_0xe137fd,_0x39f901){return _0x2ab167(_0xe137fd-0x34f,_0x39f901);}_0x4999f1['success']?(alert('登录成功'),window['location']['href']='success.html'):alert(_0x4999f1[_0xde5822(0x1cd,0x1cb)]||_0xde5822(0x1c4,0x1b3));})['catch'](_0x42a664=>console[_0x2ab167(-0x182,-0x181)]('请求错误:',_0x42a664)),closeModal();}function closeModal(){function _0x5eae07(_0x1c4b1a,_0x2faa48){return _0x2d2d16(_0x1c4b1a,_0x2faa48-0x25b);}document[_0x5eae07(0x34,0x3e)]('modal')['style']['display']='none';}