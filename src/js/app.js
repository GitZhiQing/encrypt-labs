document[_0x4f79d5(0x17c,0x181)]('loginForm')[_0x4f79d5(0x17d,0x16b)](_0x4f79d5(0x17e,0x193),function(_0xc224fa){function _0x60a14a(_0x4e494b,_0x4e63e8){return _0x4f79d5(_0x4e63e8-0xeb,_0x4e494b);}_0xc224fa[_0x60a14a(0x277,0x26a)](),document['getElementById'](_0x60a14a(0x276,0x26b))['style'][_0x60a14a(0x260,0x26c)]='flex';});function sendDataAes(_0x30cb8e){const _0x250d35={'username':document['getElementById'](_0x2fe90c(0x115,0x103))[_0x2fe90c(0x116,0x107)],'password':document['getElementById'](_0x2fe90c(0x117,0x10f))['value']},_0x807d91=JSON['stringify'](_0x250d35);function _0x2fe90c(_0x1d8ccd,_0x579d33){return _0x4f79d5(_0x1d8ccd- -0x6d,_0x579d33);}const _0x67b862=CryptoJS['enc']['Utf8']['parse']('1234567890123456'),_0x2d9cd5=CryptoJS['enc'][_0x2fe90c(0x118,0x11a)]['parse']('1234567890123456'),_0x1375d7=CryptoJS['AES'][_0x2fe90c(0x119,0x11c)](_0x807d91,_0x67b862,{'iv':_0x2d9cd5,'mode':CryptoJS[_0x2fe90c(0x11a,0x11b)]['CBC'],'padding':CryptoJS[_0x2fe90c(0x11b,0x11e)][_0x2fe90c(0x11c,0x12c)]})[_0x2fe90c(0x11d,0x10e)](),_0x550d63='encryptedData='+encodeURIComponent(_0x1375d7);fetch(_0x30cb8e,{'method':'POST','headers':{'Content-Type':_0x2fe90c(0x11e,0x12b)},'body':_0x550d63})[_0x2fe90c(0x11f,0x132)](_0x31e99a=>_0x31e99a[_0x2fe90c(0x120,0x133)]())[_0x2fe90c(0x11f,0x11a)](_0x14f6d3=>{function _0x41808e(_0x7f8e95,_0x59eee0){return _0x2fe90c(_0x7f8e95- -0x2ae,_0x59eee0);}_0x14f6d3[_0x41808e(-0x18d,-0x188)]?(alert('登录成功'),window[_0x41808e(-0x18c,-0x182)]['href']=_0x41808e(-0x18b,-0x18d)):alert('用户名或密码错误');})['catch'](_0x54e96b=>{function _0x267ca4(_0x45654b,_0x18fa07){return _0x2fe90c(_0x45654b-0x23a,_0x18fa07);}console['error'](_0x267ca4(0x35e,0x34d),_0x54e96b);}),closeModal();}function sendEncryptedDataRSA(_0x1994b9){const _0x3e25e1='\x0a-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----\x0a\x20\x20',_0x2054e8=document['getElementById']('username')['value'],_0x12c801=document['getElementById'](_0x4e70c0(0x121,0x112))[_0x4e70c0(0x120,0x12f)];function _0x4e70c0(_0x5d3de4,_0x4543b1){return _0x4f79d5(_0x5d3de4- -0x63,_0x4543b1);}const _0x30cf06={'username':_0x2054e8,'password':_0x12c801},_0x4c2fb7=JSON['stringify'](_0x30cf06),_0x2eaef7=new JSEncrypt();_0x2eaef7['setPublicKey'](_0x3e25e1);const _0xc4a2fd=_0x2eaef7[_0x4e70c0(0x123,0x11e)](_0x4c2fb7);if(!_0xc4a2fd){alert(_0x4e70c0(0x12f,0x140));return;}const _0x26edee=new URLSearchParams();_0x26edee['append'](_0x4e70c0(0x130,0x11c),_0xc4a2fd),fetch(_0x1994b9,{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x26edee['toString']()})['then'](_0xe6b8f=>_0xe6b8f[_0x4e70c0(0x12a,0x13d)]())['then'](_0x2d828c=>{function _0x328f75(_0x4f7726,_0x165312){return _0x4e70c0(_0x4f7726- -0x7f,_0x165312);}_0x2d828c['success']?(alert('登录成功'),window['location'][_0x328f75(0xb2,0xc0)]='success.html'):alert(_0x2d828c['error']||_0x328f75(0xb3,0xa7));})['catch'](_0x383b72=>console[_0x4e70c0(0x133,0x13c)]('请求错误:',_0x383b72)),closeModal();}function sendDataAesRsa(_0xcb20dc){const _0x1d6568={'username':document[_0x13ef4f(0x3bf,0x3af)]('username')[_0x13ef4f(0x3a2,0x3b6)],'password':document[_0x13ef4f(0x3c1,0x3af)](_0x13ef4f(0x3ac,0x3b7))['value']},_0x57740d=JSON[_0x13ef4f(0x3d6,0x3ca)](_0x1d6568),_0x4515a4=CryptoJS['lib']['WordArray']['random'](0x10),_0x5e9345=CryptoJS['lib']['WordArray']['random'](0x10),_0x4cf83b=CryptoJS[_0x13ef4f(0x3c1,0x3cb)][_0x13ef4f(0x3c6,0x3b9)](_0x57740d,_0x4515a4,{'iv':_0x5e9345,'mode':CryptoJS['mode']['CBC'],'padding':CryptoJS['pad'][_0x13ef4f(0x3b6,0x3bc)]})['toString'](),_0x41d8d9=new JSEncrypt();_0x41d8d9[_0x13ef4f(0x3b9,0x3cc)](_0x13ef4f(0x3de,0x3cd));const _0x2a1fb9=_0x41d8d9[_0x13ef4f(0x3c7,0x3b9)](_0x4515a4['toString'](CryptoJS[_0x13ef4f(0x3cc,0x3ce)]['Base64']));function _0x13ef4f(_0x37ca9b,_0x360cfe){return _0x4f79d5(_0x360cfe-0x233,_0x37ca9b);}const _0x1af58a=_0x41d8d9['encrypt'](_0x5e9345['toString'](CryptoJS['enc']['Base64']));fetch(_0xcb20dc,{'method':_0x13ef4f(0x3bd,0x3cf),'headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'encryptedData':_0x4cf83b,'encryptedKey':_0x2a1fb9,'encryptedIv':_0x1af58a})})['then'](_0x235dc9=>_0x235dc9['json']())['then'](_0x48c2d5=>{function _0x436ea1(_0x4c4a70,_0x56e1d3){return _0x13ef4f(_0x4c4a70,_0x56e1d3- -0x134);}_0x48c2d5['success']?(alert(_0x436ea1(0x2a2,0x29c)),window['location']['href']=_0x436ea1(0x27b,0x28f)):alert(_0x436ea1(0x290,0x294));})['catch'](_0x6e2829=>console['error'](_0x13ef4f(0x3c2,0x3c4),_0x6e2829)),closeModal();}function _0x4f79d5(_0x8e93b8,_0x5e1416){return _0x30d2(_0x8e93b8-0x26,_0x5e1416);}async function fetchAndSendDataAes(_0x2a7a46){let _0x4a090f,_0x779743;try{const _0x47f177=await fetch('encrypt/server_generate_key.php'),_0x4a20d5=await _0x47f177['json']();_0x4a090f=CryptoJS['enc']['Base64'][_0x57c5f7(0x308,0x30d)](_0x4a20d5['aes_key']),_0x779743=CryptoJS[_0x57c5f7(0x305,0x314)]['Base64'][_0x57c5f7(0x308,0x314)](_0x4a20d5['aes_iv']);}catch(_0x20a85b){console['error'](_0x57c5f7(0x309,0x306),_0x20a85b),alert(_0x57c5f7(0x30a,0x2f8));return;}const _0x2ded50={'username':document[_0x57c5f7(0x2e6,0x2d1)](_0x57c5f7(0x2ec,0x2d9))[_0x57c5f7(0x2ed,0x2f5)],'password':document['getElementById']('password')['value']},_0x138960=JSON[_0x57c5f7(0x301,0x310)](_0x2ded50);function _0x57c5f7(_0xdd69ee,_0x479ca9){return _0x4f79d5(_0xdd69ee-0x16a,_0x479ca9);}const _0x34154f=CryptoJS[_0x57c5f7(0x302,0x318)][_0x57c5f7(0x2f0,0x2e1)](_0x138960,_0x4a090f,{'iv':_0x779743,'mode':CryptoJS[_0x57c5f7(0x2f1,0x2e3)][_0x57c5f7(0x30b,0x31e)],'padding':CryptoJS[_0x57c5f7(0x2f2,0x2ec)]['Pkcs7']})['toString']();fetch(_0x2a7a46,{'method':_0x57c5f7(0x306,0x300),'headers':{'Content-Type':_0x57c5f7(0x30c,0x2fc)},'body':JSON[_0x57c5f7(0x301,0x311)]({'encryptedData':_0x34154f})})[_0x57c5f7(0x2f6,0x307)](_0x5988ef=>_0x5988ef['json']())['then'](_0x5d0892=>{function _0x335be7(_0x31d09b,_0x526807){return _0x57c5f7(_0x526807- -0x511,_0x31d09b);}_0x5d0892['success']?(alert(_0x335be7(-0x1f9,-0x20a)),window['location'][_0x335be7(-0x227,-0x213)]='success.html'):alert(_0x335be7(-0x204,-0x212));})['catch'](_0x34a4e6=>console[_0x57c5f7(0x300,0x310)]('请求错误:',_0x34a4e6)),closeModal();}function encryptAndSendDataDES(_0x525852){const _0x54dcc5=document['getElementById'](_0x927984(0x39a,0x39b))[_0x927984(0x39b,0x38c)],_0x4e8925=document[_0x927984(0x394,0x38d)]('password')['value'];function _0x927984(_0x35d0b2,_0x428008){return _0x4f79d5(_0x35d0b2-0x218,_0x428008);}const _0x28853a=CryptoJS[_0x927984(0x3b3,0x3c6)]['Utf8']['parse'](_0x54dcc5['slice'](0x0,0x8)['padEnd'](0x8,'6')),_0x360c3f=CryptoJS['enc'][_0x927984(0x39d,0x3ab)]['parse']('9999'+_0x54dcc5['slice'](0x0,0x4)['padEnd'](0x4,'9')),_0x48281f=CryptoJS['DES']['encrypt'](_0x4e8925,_0x28853a,{'iv':_0x360c3f,'mode':CryptoJS[_0x927984(0x39f,0x38a)]['CBC'],'padding':CryptoJS['pad'][_0x927984(0x3a1,0x3a0)]}),_0x232c60=_0x48281f['ciphertext'][_0x927984(0x3a2,0x38b)](CryptoJS['enc']['Hex']);fetch(_0x525852,{'method':'POST','headers':{'Content-Type':_0x927984(0x3ba,0x3d0)},'body':JSON['stringify']({'username':_0x54dcc5,'password':_0x232c60})})[_0x927984(0x3a4,0x397)](_0x1d27b6=>_0x1d27b6['json']())[_0x927984(0x3a4,0x3ac)](_0x15cd76=>{_0x15cd76['success']?(alert('登录成功'),window['location']['href']='success.html'):alert('用户名或密码错误');})['catch'](_0x495963=>console['error'](_0x927984(0x3a9,0x3b4),_0x495963)),closeModal();}function _0xd19a(){const _0x96d30d=['getElementById','addEventListener','submit','preventDefault','modal','display','username','value','password','Utf8','encrypt','mode','pad','Pkcs7','toString','application/x-www-form-urlencoded;\x20charset=utf-8','then','json','success','location','success.html','请求错误:','加密失败，请检查公钥是否正确','data','href','用户名或密码错误','error','stringify','AES','setPublicKey','-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi\x0aNH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM\x0aDSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb\x0aocDbsNeCwNpRxwjIdQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----','enc','POST','登录成功','parse','获取\x20AES\x20密钥失败:','无法获取\x20AES\x20密钥，请刷新页面重试','CBC','application/json','floor','now','/../get-signature.php','数据提交失败:','application/json;\x20charset=utf-8','catch'];_0xd19a=function(){return _0x96d30d;};return _0xd19a();}function _0x30d2(_0xb85c4e,_0xd19a71){const _0x30d2f4=_0xd19a();return _0x30d2=function(_0x37ab03,_0x251c3f){_0x37ab03=_0x37ab03-0x156;let _0x362566=_0x30d2f4[_0x37ab03];return _0x362566;},_0x30d2(_0xb85c4e,_0xd19a71);}function sendDataWithNonce(_0x4a55f){const _0x2547ae=document['getElementById'](_0x777122(0x1a1,0x1b4))['value'],_0x52eec5=document[_0x777122(0x1c0,0x1ae)](_0x777122(0x1c8,0x1b6))[_0x777122(0x1ba,0x1b5)],_0x3db627=Math['random']()[_0x777122(0x1c1,0x1bc)](0x24)['substring'](0x2),_0x1a525d=Math['floor'](Date['now']()/0x3e8),_0x2e9aaf='be56e057f20f883e',_0xaf577e=_0x2547ae+_0x52eec5+_0x3db627+_0x1a525d,_0x2ab511=CryptoJS['HmacSHA256'](_0xaf577e,_0x2e9aaf)['toString'](CryptoJS[_0x777122(0x1c1,0x1cd)]['Hex']);function _0x777122(_0x39a1cd,_0x409838){return _0x4f79d5(_0x409838-0x32,_0x39a1cd);}fetch(_0x4a55f,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0x777122(0x1c4,0x1c9)]({'username':_0x2547ae,'password':_0x52eec5,'nonce':_0x3db627,'timestamp':_0x1a525d,'signature':_0x2ab511})})['then'](_0x57ce41=>_0x57ce41['json']())['then'](_0x4ecf0a=>{function _0x113def(_0x1414f5,_0x1a25eb){return _0x777122(_0x1a25eb,_0x1414f5-0xb7);}_0x4ecf0a['success']?(alert('登录成功'),window['location']['href']='success.html'):alert(_0x4ecf0a[_0x113def(0x27f,0x273)]||'用户名或密码错误');})['catch'](_0x19e420=>console['error']('请求错误:',_0x19e420)),closeModal();}async function sendDataWithNonceServer(_0xb4476b){function _0x5b14e6(_0x9f039f,_0x3746ee){return _0x4f79d5(_0x9f039f-0xde,_0x3746ee);}const _0x41822d=document['getElementById']('username')['value'],_0x3c65d8=document['getElementById']('password')['value'],_0x173dbd=Math[_0x5b14e6(0x281,0x282)](Date[_0x5b14e6(0x282,0x26f)]()/0x3e8);try{const _0x55d2c7=await fetch(_0xb4476b+_0x5b14e6(0x283,0x28d),{'method':_0x5b14e6(0x27a,0x26b),'headers':{'Content-Type':_0x5b14e6(0x280,0x26f)},'body':JSON['stringify']({'username':_0x41822d,'password':_0x3c65d8,'timestamp':_0x173dbd})});closeModal();if(!_0x55d2c7['ok']){console['error']('获取签名失败:',_0x55d2c7['statusText']),alert('获取签名失败，请稍后重试。');return;}const {signature:_0x2755ad}=await _0x55d2c7[_0x5b14e6(0x26b,0x279)]();if(!_0x2755ad){alert('签名获取失败，服务器未返回签名。');return;}const _0x58deb5=await fetch(''+_0xb4476b,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'username':_0x41822d,'password':_0x3c65d8,'timestamp':_0x173dbd,'signature':_0x2755ad})});if(!_0x58deb5['ok']){console['error'](_0x5b14e6(0x284,0x28b),_0x58deb5['statusText']),alert('提交数据失败，请稍后重试。');return;}const _0x22648d=await _0x58deb5['json']();_0x22648d[_0x5b14e6(0x26c,0x26a)]?(alert('登录成功'),window['location']['href']='success.html'):alert(_0x22648d[_0x5b14e6(0x274,0x285)]||'用户名或密码错误');}catch(_0x30ffca){console['error'](_0x5b14e6(0x26f,0x265),_0x30ffca),alert('发生错误，请稍后重试。');}}function generateRequestData(){function _0x34b479(_0x38b999,_0x500418){return _0x4f79d5(_0x38b999-0x1e4,_0x500418);}const _0x1da0ac=document[_0x34b479(0x360,0x357)](_0x34b479(0x366,0x379))['value'],_0x4fdc07=document[_0x34b479(0x360,0x360)](_0x34b479(0x368,0x37d))[_0x34b479(0x367,0x351)],_0x5a8525=Date[_0x34b479(0x388,0x37a)](),_0x9f2be4=_0x34b479(0x37e,0x381);function _0x5b0e97(_0x482893,_0x201f27){const _0x3ef89b=new JSEncrypt();_0x3ef89b[_0x434cfc(0x300,0x2f2)](_0x201f27);const _0x311c6b=_0x3ef89b[_0x434cfc(0x2ed,0x2fc)](_0x482893['toString']());function _0x434cfc(_0x57eb61,_0x7fc509){return _0x34b479(_0x57eb61- -0x7d,_0x7fc509);}if(!_0x311c6b)throw new Error('RSA\x20encryption\x20failed.');return _0x311c6b;}let _0x110e21;try{_0x110e21=_0x5b0e97(_0x5a8525,_0x9f2be4);}catch(_0x16a5f1){return console['error']('Encryption\x20error:',_0x16a5f1),null;}const _0x163cb9={'username':_0x1da0ac,'password':_0x4fdc07,'random':_0x110e21};return _0x163cb9;}function sendLoginRequest(_0x434a60){const _0x295e29=generateRequestData();function _0x2f073d(_0x4a1d2e,_0x410fbd){return _0x4f79d5(_0x4a1d2e-0x3ba,_0x410fbd);}fetch(_0x434a60,{'method':_0x2f073d(0x556,0x55c),'headers':{'Content-Type':_0x2f073d(0x561,0x55f)},'body':JSON[_0x2f073d(0x551,0x547)](_0x295e29)})[_0x2f073d(0x546,0x538)](_0x5d7c82=>_0x5d7c82['json']())['then'](_0x8209e9=>{function _0x1fb957(_0x2afce9,_0x598e94){return _0x2f073d(_0x598e94- -0x692,_0x2afce9);}_0x8209e9['success']?(alert('登录成功'),window['location']['href']='success.html'):alert(_0x8209e9[_0x1fb957(-0x14e,-0x142)]||_0x1fb957(-0x146,-0x143));})[_0x2f073d(0x562,0x577)](_0x428887=>console[_0x2f073d(0x550,0x557)](_0x2f073d(0x54b,0x53a),_0x428887)),closeModal();}function closeModal(){function _0x52daae(_0x450a14,_0x22a73c){return _0x4f79d5(_0x22a73c-0x313,_0x450a14);}document[_0x52daae(0x484,0x48f)](_0x52daae(0x4a0,0x493))['style']['display']='none';}